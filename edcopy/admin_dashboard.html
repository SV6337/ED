<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Panel - EDVANTAGE</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link rel="manifest" href="manifest.json">

<style>
  :root {
    /* Light Mode Colors */
    --primary: #008080;
    --primary-light: #83c5be;
    --primary-dark: #004e5a;
    --secondary: #3a506b;
    --accent: #ff9e7d;
    --light: #f8f9fa;
    --dark: #2b2d42;
    --gray: #e9ecef;
    --success: #4caf50;
    --warning: #ff9800;
    --danger: #f44336;
    --card-bg: #ffffff;
    --text-primary: #2b2d42;
    --text-secondary: #4a4e69;
    --border-color: rgba(0, 0, 0, 0.08);
    --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    --sidebar-bg: linear-gradient(180deg, var(--primary-dark), var(--primary));
    
    /* Dark Mode Colors - will be applied when dark class is added to body */
    --dark-primary: #008080;
    --dark-primary-light: #006d77;
    --dark-primary-dark: #004e5a;
    --dark-secondary: #b8c2cc;
    --dark-accent: #ff9e7d;
    --dark-light: #121212;
    --dark-dark: #e0e0e0;
    --dark-gray: #1e1e1e;
    --dark-card-bg: #1e1e1e;
    --dark-text-primary: #e0e0e0;
    --dark-text-secondary: #b8c2cc;
    --dark-border-color: rgba(255, 255, 255, 0.08);
    --dark-card-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    --dark-sidebar-bg: linear-gradient(180deg, #004e5a, #002a33);
    
    /* Shared Variables */
    --sidebar-width: 280px;
    --border-radius: 12px;
    --transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  body {
    font-family: 'Poppins', sans-serif;
    margin: 0;
    padding: 0;
    background-color: var(--light);
    color: var(--text-primary);
    line-height: 1.6;
    transition: background-color 0.3s ease, color 0.3s ease;
  }
  
  body.dark {
    --primary: var(--dark-primary);
    --primary-light: var(--dark-primary-light);
    --primary-dark: var(--dark-primary-dark);
    --secondary: var(--dark-secondary);
    --accent: var(--dark-accent);
    --light: var(--dark-light);
    --dark: var(--dark-dark);
    --gray: var(--dark-gray);
    --card-bg: var(--dark-card-bg);
    --text-primary: var(--dark-text-primary);
    --text-secondary: var(--dark-text-secondary);
    --border-color: var(--dark-border-color);
    --card-shadow: var(--dark-card-shadow);
    --sidebar-bg: var(--dark-sidebar-bg);
  }
  
   /* Theme Toggle Switch - Updated Style */
  .theme-toggle {
    position: fixed;
    bottom: 25px;
    right: 25px;
    z-index: 1000;
  }
  
  .toggle-container {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 50px;
    height: 50px;
    background: var(--card-bg);
    border-radius: 50%;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    cursor: pointer;
    transition: all 0.3s ease;
    border: 2px solid var(--border-color);
  }
  
  .toggle-container:hover {
    transform: scale(1.1);
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
  }
  
  .toggle-icon {
    font-size: 1.4rem;
    color: var(--primary);
    transition: all 0.3s ease;
  }
  
  body.dark .toggle-icon {
    color: var(--accent);
  }
  
  /* Container */
  .container {
    display: flex;
    min-height: 100vh;
  }
  
  /* Sidebar Styles */
  .sidebar {
    width: var(--sidebar-width);
    background: var(--sidebar-bg);
    color: white;
    padding: 20px 0;
    box-shadow: 2px 0 15px rgba(0,0,0,0.1);
    transition: var(--transition);
    position: fixed;
    height: 100vh;
    z-index: 100;
  }
  
  .sidebar-header {
    padding: 0 20px 20px;
    border-bottom: 1px solid rgba(255,255,255,0.15);
    margin-bottom: 20px;
  }
  
  .sidebar-header h2 {
    margin: 0;
    font-size: 1.5rem;
    font-weight: 600;
    color: white;
    display: flex;
    align-items: center;
    gap: 10px;
  }
  
  .sidebar-nav {
    list-style: none;
    padding: 0;
    margin: 0;
  }
  
  .sidebar-nav li a {
    display: flex;
    align-items: center;
    color: white;
    text-decoration: none;
    padding: 14px 25px;
    transition: var(--transition);
    border-left: 4px solid transparent;
    font-size: 0.95rem;
    margin: 4px 0;
  }
  
  .sidebar-nav li a:hover,
  .sidebar-nav li a.active {
    background-color: rgba(255,255,255,0.1);
    border-left: 4px solid var(--accent);
  }
  
  .sidebar-nav li a i {
    margin-right: 12px;
    width: 20px;
    text-align: center;
    font-size: 1.1rem;
    color: rgba(255,255,255,0.8);
  }
  
  /* Main Content Styles */
  .main-content {
    flex: 1;
    padding: 30px;
    background-color: var(--light);
    margin-left: var(--sidebar-width);
    min-height: 100vh;
    transition: background-color 0.3s ease;
  }
  
  .header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 30px;
    padding-bottom: 20px;
    border-bottom: 1px solid var(--border-color);
  }
  
  .header h1 {
    margin: 0;
    font-size: 1.8rem;
    color: var(--primary);
    font-weight: 600;
  }
  
  .logout-btn {
    background-color: var(--primary);
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: var(--border-radius);
    cursor: pointer;
    font-family: 'Poppins', sans-serif;
    font-weight: 500;
    transition: var(--transition);
    display: flex;
    align-items: center;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  }
  
  .logout-btn:hover {
    background-color: var(--primary-dark);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  }
  
  .logout-btn i {
    margin-right: 8px;
  }
  
  /* Card Styles */
  .card {
    background-color: var(--card-bg);
    border-radius: var(--border-radius);
    padding: 25px;
    margin-bottom: 30px;
    box-shadow: var(--card-shadow);
    transition: var(--transition);
    border: none;
  }
  
  .card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 24px rgba(0,0,0,0.12);
  }
  
  .card h3 {
    margin-top: 0;
    color: var(--primary);
    font-size: 1.4rem;
    font-weight: 600;
    padding-bottom: 15px;
    border-bottom: 1px solid var(--border-color);
    display: flex;
    align-items: center;
    gap: 10px;
  }
  
  /* Form Styles */
  .form-group {
    margin-bottom: 20px;
  }
  
  .form-group label {
    display: block;
    margin-bottom: 8px;
    font-weight: 500;
    color: var(--text-primary);
  }
  
  .form-control {
    width: 100%;
    padding: 12px 15px;
    border: 1px solid var(--border-color);
    border-radius: 8px;
    font-family: 'Poppins', sans-serif;
    transition: var(--transition);
    background-color: var(--card-bg);
    color: var(--text-primary);
  }
  
  .form-control:focus {
    border-color: var(--primary);
    outline: none;
    box-shadow: 0 0 0 3px rgba(0, 109, 119, 0.1);
  }
  
  textarea.form-control {
    min-height: 100px;
    resize: vertical;
  }
  
  /* Button Styles */
  .btn {
    padding: 12px 24px;
    border: none;
    border-radius: var(--border-radius);
    cursor: pointer;
    font-family: 'Poppins', sans-serif;
    font-weight: 500;
    transition: var(--transition);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  }
  
  .btn i {
    margin-right: 8px;
  }
  
  .btn-primary {
    background-color: var(--primary);
    color: white;
  }
  
  .btn-primary:hover {
    background-color: var(--primary-dark);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  }
  
  .btn-secondary {
    background-color: var(--secondary);
    color: white;
  }
  
  .btn-secondary:hover {
    background-color: #2c3a4d;
    transform: translateY(-2px);
  }
  
  .btn-success {
    background-color: var(--success);
    color: white;
  }
  
  .btn-success:hover {
    background-color: #43a047;
    transform: translateY(-2px);
  }
  
  .btn-danger {
    background-color: var(--danger);
    color: white;
  }
  
  .btn-danger:hover {
    background-color: #e53935;
    transform: translateY(-2px);
  }
  
  /* Table Styles */
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
    background-color: var(--card-bg);
    border-radius: var(--border-radius);
    overflow: hidden;
    box-shadow: var(--card-shadow);
  }
  
  th, td {
    padding: 14px 16px;
    text-align: left;
    border-bottom: 1px solid var(--border-color);
    color: var(--text-primary);
  }
  
  th {
    background: linear-gradient(to right, var(--primary), var(--primary-dark));
    color: white;
    font-weight: 500;
  }
  
  tr:hover td {
    background-color: rgba(131, 197, 190, 0.1);
  }
  
  .action-btns {
    display: flex;
    gap: 8px;
  }
  
  .action-btns button {
    padding: 6px 12px;
    font-size: 0.85rem;
    border-radius: 6px;
    transition: var(--transition);
  }
  
  .action-btns button.edit {
    background-color: var(--primary-light);
    color: white;
    border: none;
  }
  
  .action-btns button.edit:hover {
    background-color: var(--primary);
    transform: translateY(-1px);
  }
  
  .action-btns button.delete {
    background-color: var(--danger);
    color: white;
    border: none;
  }
  
  .action-btns button.delete:hover {
    background-color: #e53935;
    transform: translateY(-1px);
  }
  
  /* Tab Styles */
  .tab-content {
    display: none;
  }
  
  .tab-content.active {
    display: block;
    animation: fadeIn 0.3s;
  }
  
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }
  
  /* Import Section */
  .import-section {
    margin-top: 30px;
    padding-top: 20px;
    border-top: 1px solid var(--border-color);
  }
  
  .file-input-wrapper {
    position: relative;
    margin-bottom: 15px;
  }
  
  .file-input-wrapper input[type="file"] {
    position: absolute;
    left: 0;
    top: 0;
    opacity: 0;
    width: 100%;
    height: 100%;
    cursor: pointer;
  }
  
  .file-input-label {
    display: block;
    padding: 25px;
    border: 2px dashed var(--border-color);
    border-radius: var(--border-radius);
    text-align: center;
    cursor: pointer;
    transition: var(--transition);
    background-color: rgba(0, 109, 119, 0.03);
    color: var(--text-primary);
  }
  
  .file-input-label:hover {
    border-color: var(--primary);
    background-color: rgba(0, 109, 119, 0.05);
    transform: translateY(-2px);
  }
  
  .file-input-label i {
    display: block;
    font-size: 28px;
    margin-bottom: 10px;
    color: var(--primary);
  }
  
  .file-input-label span {
    display: block;
    margin-bottom: 5px;
    font-weight: 500;
  }
  
  .file-input-label small {
    color: var(--text-secondary);
    font-size: 0.85rem;
  }
  
  /* Loading Spinner */
  .spinner {
    border: 4px solid rgba(0, 0, 0, 0.1);
    border-radius: 50%;
    border-top: 4px solid var(--primary);
    width: 30px;
    height: 30px;
    animation: spin 1s linear infinite;
    margin: 0 auto;
  }
  
  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
  
  /* Status Badges */
  .badge {
    display: inline-block;
    padding: 4px 10px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 500;
  }
  
  .badge-success {
    background-color: rgba(76, 175, 80, 0.2);
    color: #43a047;
  }
  
  .badge-danger {
    background-color: rgba(244, 67, 54, 0.2);
    color: #e53935;
  }
  
  /* Multiple Select */
  select[multiple] {
    min-height: 120px;
    background-color: var(--card-bg);
    color: var(--text-primary);
  }
  
  /* showToast Messages */
  .showToast {
    padding: 15px;
    border-radius: var(--border-radius);
    margin-bottom: 20px;
  }
  
  .showToast-success {
    background-color: rgba(76, 175, 80, 0.2);
    color: #43a047;
    border-left: 4px solid var(--success);
  }
  
  .showToast-danger {
    background-color: rgba(244, 67, 54, 0.2);
    color: #e53935;
    border-left: 4px solid var(--danger);
  }
  
  /* Section headings in View All tab */
  .section-heading {
    color: var(--primary);
    margin: 30px 0 15px;
    padding-bottom: 10px;
    border-bottom: 1px solid var(--border-color);
    display: flex;
    align-items: center;
    gap: 10px;
  }
  
  /* Responsive Styles */
  @media (max-width: 768px) {
  .sidebar {
    width: 80%;
    left: -100%;
    transition: left 0.3s ease;
  }

  .sidebar.active {
    left: 0;
    position: fixed;
    z-index: 1001;
  }

  .main-content {
    margin-left: 0 !important;
    padding: 20px;
  }

  /* ======================
   HAMBURGER MENU (MOBILE)
====================== */

.hamburger {
  display: flex;                     /* ðŸ‘ˆ always visible */
  position: fixed;
  top: 18px;
  left: 18px;
  width: 42px;
  height: 42px;
  border-radius: 10px;
  border: none;
  background: var(--card-bg);
  box-shadow: var(--card-shadow);
  cursor: pointer;
  z-index: 1200;
  align-items: center;
  justify-content: center;
}

.hamburger i {
  font-size: 18px;
  color: var(--text-primary);
}



  .header {
    flex-direction: column;
    align-items: flex-start;
    gap: 10px;
  }

  .header h1 {
    font-size: 1.3rem;
  }

  .logout-btn {
    padding: 8px 16px;
    font-size: 14px;
  }

  .card {
    padding: 15px;
    margin-bottom: 20px;
  }

  .summary-section {
    flex-direction: column;
    gap: 16px;
  }

  .summary-card {
    width: 100%;
    text-align: center;
  }

  table {
    display: block;
    width: 100%;
    overflow-x: auto;
    font-size: 14px;
  }

  th, td {
    white-space: nowrap;
    padding: 10px 12px;
  }
}

@media (max-width: 480px) {
  .header h1 {
    font-size: 1.1rem;
  }

  .summary-card h3 {
    font-size: 1rem;
  }

  .toggle-container {
    width: 40px;
    height: 40px;
  }

  .toggle-icon {
    font-size: 1.2rem;
  }
}

/* ================================
   INDUSTRIAL CTA + LAYOUT SYSTEM
================================ */

/* Content width discipline */
.page-container {
  max-width: 1100px;
  margin: 0 auto;
}

/* Form grid system */
.form-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 20px 24px;
}

@media (max-width: 768px) {
  .form-grid {
    grid-template-columns: 1fr;
  }
}



/* CTA hierarchy */
.btn {
  min-height: 44px;
  padding: 10px 20px;
  font-size: 0.95rem;
}

.btn-primary {
  background: linear-gradient(
    135deg,
    var(--primary),
    var(--primary-dark)
  );
}

.btn-secondary {
  background: transparent;
  color: var(--text-primary);
  border: 1px solid var(--border-color);
  box-shadow: none;
}

.btn-secondary:hover {
  background-color: var(--gray);
  transform: none;
}

/* Subtle focus accessibility */
.form-control:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(0, 128, 128, 0.15);
}

/* Card spacing polish */
.card {
  padding: 28px 30px;
}

/* Section description text */
.section-hint {
  font-size: 0.9rem;
  color: var(--text-secondary);
  margin-bottom: 20px;
}

/* Reduce excessive hover lift */
.card:hover {
  transform: translateY(-2px);
}

/* Button loading ready (future use) */
.btn.loading {
  pointer-events: none;
  opacity: 0.7;
}

/* ======================
   TOAST NOTIFICATIONS
====================== */

.toast-container {
  position: fixed;
  top: 24px;
  right: 24px;
  z-index: 2000;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.toast {
  min-width: 260px;
  padding: 14px 18px;
  border-radius: 10px;
  background: var(--card-bg);
  box-shadow: var(--card-shadow);
  border-left: 4px solid var(--primary);
  animation: slideIn 0.25s ease;
  font-size: 0.9rem;
}

.toast.success { border-color: var(--success); }
.toast.error { border-color: var(--danger); }

@keyframes slideIn {
  from { transform: translateX(40px); opacity: 0; }
  to { transform: translateX(0); opacity: 1; }
}

.form-control.invalid {
  border-color: var(--danger);
  background-color: rgba(244,67,54,0.04);
}
.form-error {
  font-size: 0.75rem;
  color: var(--danger);
  margin-top: 4px;
}

.breadcrumb {
  font-size: 0.8rem;
  color: var(--text-secondary);
}

.btn.loading {
  opacity: 0.7;
  pointer-events: none;
}

.empty-state {
  text-align: center;
  padding: 40px;
  color: var(--text-secondary);
  font-size: 0.9rem;
}

.table-toolbar {
  display: flex;
  justify-content: flex-end;
  margin: 12px 0 20px;
  max-width: 400px;
}

.pagination {
  display: flex;
  gap: 6px;
  justify-content: flex-end;
  margin-top: 12px;
}

.pagination button {
  border: 1px solid var(--border-color);
  background: var(--card-bg);
  padding: 6px 12px;
  border-radius: 6px;
  cursor: pointer;
}

.pagination button.active {
  background: var(--primary);
  color: white;
}

/* =========================
   INLINE EDITING STYLES
========================= */

.table-input {
  width: 100%;
  padding: 6px 8px;
  font-size: 0.85rem;
  border-radius: 6px;
  border: 1px solid var(--border-color);
  font-family: inherit;
}

.row-actions {
  display: flex;
  gap: 6px;
}

.btn-small {
  padding: 4px 10px;
  font-size: 0.75rem;
  border-radius: 6px;
}

.modal-backdrop {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.45);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 3000;
}

.modal {
  background: var(--card-bg);
  padding: 24px;
  border-radius: 12px;
  width: 320px;
}

/* Desktop collapse */
.sidebar.collapsed {
  width: 80px;
}

.sidebar.collapsed .sidebar-header h2 span {
  display: none;
}

.sidebar.collapsed .sidebar-nav a span {
  display: none;
}

.main-content.collapsed {
  margin-left: 80px;
}

/* FORCE HAMBURGER VISIBILITY */
.hamburger {
  display: flex !important;
  position: fixed !important;
  top: 16px !important;
  left: 16px !important;
  width: 44px !important;
  height: 44px !important;
  border-radius: 10px;
  background: white;
  border: none;
  z-index: 9999 !important;   /* ðŸ‘ˆ force on top */
  align-items: center;
  justify-content: center;
  cursor: pointer;
  box-shadow: 0 6px 16px rgba(0,0,0,0.2);
}

.hamburger i {
  font-size: 20px;
  color: black;
}

/* ============================
   HAMBURGER ANIMATION
============================ */

.hamburger {
  flex-direction: column;
  gap: 5px;
}

.hamburger span {
  display: block;
  width: 22px;
  height: 2px;
  background: var(--text-primary);
  border-radius: 2px;
  transition: 0.3s ease;
}

/* Active = X */
.hamburger.active span:nth-child(1) {
  transform: translateY(7px) rotate(45deg);
}

.hamburger.active span:nth-child(2) {
  opacity: 0;
}

.hamburger.active span:nth-child(3) {
  transform: translateY(-7px) rotate(-45deg);
}

.sidebar {
  transition: width 0.25s ease, transform 0.25s ease;
}

.main-content {
  transition: margin-left 0.25s ease;
}

/* ============================
   MOBILE LAYOUT FIX
============================ */

@media (max-width: 768px) {

  /* Sidebar becomes overlay drawer */
  .sidebar {
    position: fixed;
    top: 0;
    left: 0;
    height: 100vh;
    transform: translateX(-100%);
    width: 260px;
    z-index: 1500;
  }

  .sidebar.active {
    transform: translateX(0);
  }

  /* Main content must be full width */
  .main-content {
    margin-left: 0 !important;
    width: 100%;
  }

  /* Disable collapsed behavior on mobile */
  .sidebar.collapsed {
    width: 260px;
  }

  .main-content.collapsed {
    margin-left: 0 !important;
  }

  /* Hamburger positioning */
  .hamburger {
    top: 14px;
    left: 14px;
  }

  /* Prevent body scroll when menu open */
  body.menu-open {
    overflow: hidden;
  }

}

@media (max-width: 768px) {

  .header {
    padding-left: 64px;   /* make room for hamburger */
    flex-direction: column;
    align-items: flex-start;
    gap: 8px;
  }

  .header h1 {
    font-size: 1.2rem;
  }

  .logout-btn {
    align-self: flex-start;
  }

}

@media (max-width: 768px) {

  .form-grid {
    grid-template-columns: 1fr !important;
  }


}

/* ============================
   MOBILE APP BAR
============================ */

@media (max-width: 768px) {

  .header {
    height: 52px;
    padding: 0 12px 0 56px;
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  .header h1 {
    font-size: 0.9rem;
  }

  .breadcrumb {
    display: none;
  }

  .logout-btn {
    padding: 6px 10px;
    font-size: 0.7rem;
  }

}


@media (max-width: 768px) {

  .form-control {
    height: 40px;
    font-size: 0.85rem;
  }

  label {
    font-size: 0.75rem;
  }

}

@media (max-width: 768px) {


  /* Prevent content hiding under CTA bar */
  .main-content {
    padding-bottom: 90px;
  }

}


@media (max-width: 768px) {

  .form-group {
    margin-bottom: 12px;
  }

}

@media (max-width: 768px) {

  .header {
    position: sticky;
    top: 0;
    z-index: 100;
    background: var(--bg);
    padding: 10px 12px 10px 56px;
    border-bottom: 1px solid var(--border-color);
    display: flex;
    flex-direction: column;
    gap: 2px;
  }

  .header h1 {
    font-size: 1rem;
    font-weight: 600;
    line-height: 1.2;
  }

  .breadcrumb {
    font-size: 0.65rem;
    opacity: 0.7;
  }

  /* Make logout compact icon-style */
  .logout-btn {
    position: absolute;
    right: 12px;
    top: 10px;
    padding: 6px 10px;
    font-size: 0.7rem;
    border-radius: 999px;
  }

}

@media (max-width: 768px) {

  .card {
    border-radius: 18px;
    padding: 14px;
    box-shadow: 0 6px 18px rgba(0,0,0,0.05);
  }

  .card h3 {
    font-size: 0.95rem;
    margin-bottom: 4px;
  }

  .section-hint {
    font-size: 0.75rem;
    line-height: 1.3;
  }

}


@media (max-width: 768px) {

  label {
    font-size: 0.7rem;
    margin-bottom: 4px;
  }

  .form-control {
    height: 36px;
    font-size: 0.8rem;
    padding: 6px 10px;
    border-radius: 8px;
  }

  .form-group {
    margin-bottom: 10px;
  }

}

@media (max-width: 768px) {

  .page-container {
    padding: 12px;
  }

  .tab-content {
    padding-top: 10px;
  }

}

/* Touch feedback */
.sidebar a:active {
  transform: scale(0.98);
}

.btn:active {
  transform: scale(0.97);
}

/* ============================
   MOBILE GROUPED FORM UX
============================ */

@media (max-width: 768px) {

  .mobile-group {
    margin-bottom: 14px;
    padding: 12px;
    background: rgba(0,0,0,0.02);
    border-radius: 12px;
  }

  .mobile-group h4 {
    font-size: 0.7rem;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    margin-bottom: 8px;
    opacity: 0.6;
  }

}

/* ============================
   FLOATING PRIMARY ACTION
============================ */

@media (max-width: 768px) {

  .fab {
    position: fixed;
    right: 16px;
    bottom: 16px;
    height: 54px;
    padding: 0 22px;
    border-radius: 999px;
    background: var(--primary);
    color: white;
    font-size: 0.9rem;
    font-weight: 600;
    box-shadow: 0 12px 28px rgba(0,0,0,0.2);
    display: flex;
    align-items: center;
    gap: 8px;
    z-index: 200;
  }

  .fab-secondary {
    display: none;
  }

}

/* ============================
   PERFECT CENTER HEADER TITLE
============================ */

@media (max-width: 768px) {

  .header {
    position: relative;
  }

  .header-title {
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    pointer-events: none; /* allows clicks on buttons */
  }

  .header-title h1 {
    font-size: 0.9rem;
    font-weight: 600;
    white-space: nowrap;
  }

}


</style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
  
  <div class="container">
    <!-- Sidebar -->
    <div class="sidebar">
      <div class="sidebar-header">
        <h2><i class="fas fa-graduation-cap"></i><span> EDVANTAGE</span></h2>
      </div>
      <ul class="sidebar-nav">
        <li><a href="#" onclick="showTab('teacher')" class="active"><i class="fas fa-chalkboard-teacher"></i><span> Teachers</span></a></li>
        <li><a href="#" onclick="showTab('student')"><i class="fas fa-user-graduate"></i> <span>Students</span></a></li>
        <li><a href="#" onclick="showTab('course')"><i class="fas fa-book"></i><span> Courses</span></a></li>
        <li><a href="#" onclick="showTab('subject')"><i class="fas fa-book-open"></i> <span>Subjects</span></a></li>
        <li><a href="#" onclick="showTab('assign')"><i class="fas fa-users"></i> <span>Classes</span></a></li>
        <li><a href="#" onclick="showTab('view-all')"><i class="fas fa-table"></i> <span>View All</span></a></li>
        
      </ul>
    </div>


<!-- Hamburger Button -->
<button class="hamburger" id="hamburgerBtn" aria-label="Toggle menu">
  <span></span>
  <span></span>
  <span></span>
</button>


<!-- Mobile Overlay -->
<div class="mobile-overlay" id="mobileOverlay"></div>


    <!-- Main Content -->
    <div class="main-content">
      <div class="header">
        <div class="header-title">
  <h1>Admin Dashboard</h1>
</div>

        <div class="breadcrumb" id="breadcrumb">Admin / Teachers</div>
        <button class="logout-btn" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Logout</button>
      </div>

   
   <!-- Teacher Tab -->
      <div id="teacher" class="tab-content active">
  <div class="card page-container">
    <h3><i class="fas fa-chalkboard-teacher"></i> Add Teacher</h3>
    <p class="section-hint">
      Create a teacher profile and assign them to classes later.
    </p>

    <div class="form-grid">
      <div class="mobile-group">
        <h4>Teacher Info</h4>
        <div class="form-group">
          <label for="teacher-id">Teacher ID</label>
          <input type="text" id="teacher-id" class="form-control" placeholder="EMP001">
        </div>

        <div class="form-group">
          <label for="teacher-name">Full Name</label>
          <input type="text" id="teacher-name" class="form-control" placeholder="John Doe">
        </div>
      </div>

      <div class="mobile-group">
        <h4>Contact</h4>
        <div class="form-group">
          <label for="teacher-email">Email</label>
          <input type="email" id="teacher-email" class="form-control" placeholder="john@school.edu">
        </div>

        <div class="form-group">
          <label for="teacher-phone">Phone Number</label>
          <input type="tel" id="teacher-phone" class="form-control" placeholder="+91 XXXXX XXXXX">
        </div>
      </div>

      <div class="mobile-group">
        <h4>Security</h4>
        <div class="form-group">
          <label for="teacher-password">Temporary Password</label>
          <input type="password" id="teacher-password" class="form-control" placeholder="Auto-generated or manual">
        </div>
      </div>
    </div>

    <div class="cta-bar">
      <button class="btn fab" onclick="addTeacher()">
  <i class="fas fa-plus"></i>
  Create
</button>

<button class="btn fab-secondary" type="reset">
  Clear
</button>

    </div>
  </div>
</div>


      <!-- Student Tab -->
      <div id="student" class="tab-content">
  <div class="card page-container">
    <h3><i class="fas fa-user-graduate"></i> Add Student</h3>
    <p class="section-hint">
      Register a student profile or bulk-import using Excel.
    </p>

    <div class="form-grid">
      <div class="form-group">
        <label for="student-id">Student ID</label>
        <input type="text" id="student-id" class="form-control" placeholder="STU001">
      </div>

      <div class="form-group">
        <label for="student-name">Full Name</label>
        <input type="text" id="student-name" class="form-control" placeholder="Jane Doe">
      </div>

      <div class="form-group">
        <label for="student-email">Email</label>
        <input type="email" id="student-email" class="form-control" placeholder="jane@college.edu">
      </div>

      <div class="form-group">
        <label for="student-phone">Phone Number</label>
        <input type="tel" id="student-phone" class="form-control" placeholder="+91 XXXXX XXXXX">
      </div>

      <div class="form-group">
        <label for="student-password">Temporary Password</label>
        <input type="password" id="student-password" class="form-control">
      </div>
    </div>

    <div class="cta-bar">
      <button class="btn btn-secondary" type="reset">Clear</button>
      <button class="btn btn-primary" onclick="addStudent()">
        <i class="fas fa-user-plus"></i>
        Create Student
      </button>
    </div>

    <!-- Import Section -->
    <div class="import-section">
      <h4><i class="fas fa-file-import"></i> Bulk Import Students</h4>

      <div class="file-input-wrapper">
        <input type="file" id="excel-file" accept=".xlsx">
        <label for="excel-file" class="file-input-label">
          <i class="fas fa-file-excel"></i>
          <span>Upload Excel File</span>
          <small>Use the provided template (.xlsx)</small>
        </label>
      </div>

      <div class="cta-bar">
        <button class="btn btn-secondary" onclick="downloadSampleExcel()">
          Download Template
        </button>
        <button class="btn btn-success" onclick="importStudentsFromExcel()">
          Import Students
        </button>
      </div>
    </div>
  </div>
</div>


      <!-- Course Tab -->
      <div id="course" class="tab-content">
  <div class="card page-container">
    <h3><i class="fas fa-book"></i> Add Course</h3>
    <p class="section-hint">
      Create a new academic course to organize subjects and classes.
    </p>

    <div class="form-grid">
      <div class="form-group">
        <label for="course-name">Course Name</label>
        <input type="text" id="course-name" class="form-control" placeholder="Computer Science Engineering">
      </div>
    </div>

    <div class="cta-bar">
      <button class="btn btn-secondary" type="reset">Clear</button>
      <button class="btn btn-primary" onclick="addCourse()">
        <i class="fas fa-plus"></i>
        Create Course
      </button>
    </div>
  </div>
</div>


      <!-- Subject Tab -->
      <div id="subject" class="tab-content">
  <div class="card page-container">
    <h3><i class="fas fa-book-open"></i> Add Subject</h3>
    <p class="section-hint">
      Assign subjects under an academic course.
    </p>

    <div class="form-grid">
      <div class="form-group">
        <label for="subject-course-dropdown">Course</label>
        <select id="subject-course-dropdown" class="form-control"></select>
      </div>

      <div class="form-group">
        <label for="subject-name">Subject Name</label>
        <input type="text" id="subject-name" class="form-control" placeholder="Data Structures">
      </div>
    </div>

    <div class="cta-bar">
      <button class="btn btn-secondary" type="reset">Clear</button>
      <button class="btn btn-primary" onclick="addSubject()">
        <i class="fas fa-plus"></i>
        Create Subject
      </button>
    </div>
  </div>
</div>


      <!-- Assign Class Tab -->
      <div id="assign" class="tab-content">
  <div class="card page-container">
    <h3><i class="fas fa-users"></i> Assign Class</h3>
    <p class="section-hint">
      Map teachers, students, and subjects into a class group.
    </p>

    <div class="form-grid">
      <div class="form-group">
        <label for="class-name">Class Name</label>
        <input type="text" id="class-name" class="form-control" placeholder="CSE-A 2026">
      </div>

      <div class="form-group">
        <label for="teacher-dropdown">Teacher</label>
        <select id="teacher-dropdown" class="form-control"></select>
      </div>

      <div class="form-group">
        <label for="assign-course-dropdown">Course</label>
        <select id="assign-course-dropdown" class="form-control" onchange="loadSubjectsByCourse()"></select>
      </div>

      <div class="form-group">
        <label for="assign-subject-dropdown">Subject</label>
        <select id="assign-subject-dropdown" class="form-control"></select>
      </div>

      <div class="form-group" style="grid-column: span 2;">
        <label for="students-dropdown">Students</label>
        <select id="students-dropdown" multiple class="form-control"></select>
      </div>
    </div>

    <div class="cta-bar">
      <button class="btn btn-secondary" type="reset">Clear</button>
      <button class="btn btn-primary" onclick="assignClass()">
        <i class="fas fa-check-circle"></i>
        Assign Class
      </button>
    </div>
  </div>
</div>


      <!-- View All Tab -->
      <div id="view-all" class="tab-content">
        <div class="card">
          <h3><i class="fas fa-table"></i> View All Data</h3>
          <div class="table-toolbar">
 <input 
    type="text"
    id="globalSearch"
    class="form-control"
    placeholder="Search teachers, students, courses..."
    oninput="filterTables()"
  />
</div>


          <h4><i class="fas fa-chalkboard-teacher"></i> Teachers</h4>
          <!-- In the View All Teachers table section -->
<table id="view-all-teachers">
  <thead>
    <tr>
      <th>Teacher ID</th>
      <th>Name</th>
      <th>Email</th>
      <th>Phone</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<!-- In the View All Students table section -->
<table id="view-all-students">
  <thead>
    <tr>
      <th>Student ID</th>
      <th>Name</th>
      <th>Email</th>
      <th>Phone</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

          <h4 style="margin-top: 30px;"><i class="fas fa-book"></i> Courses</h4>
          <table id="view-all-courses">
            <thead>
              <tr>
                <th>Name</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>

          <h4 style="margin-top: 30px;"><i class="fas fa-book-open"></i> Subjects</h4>
          <table id="view-all-subjects">
            <thead>
              <tr>
                <th>Name</th>
                <th>Course</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>

          <h4 style="margin-top: 30px;"><i class="fas fa-users"></i> Assigned Classes</h4>
          <table id="view-all-classes">
            <thead>
              <tr>
                <th>Class Name</th>
                <th>Teacher</th>
                <th>Students</th>
                <th>Course</th>
                <th>Subject</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
    <div class="toast-container" id="toastContainer"></div>

    <div class="modal-backdrop" id="confirmModal">
  <div class="modal">
    <h3>Confirm Action</h3>
    <p id="confirmText">Are you sure?</p>
    <div class="cta-bar">
      <button class="btn btn-secondary" onclick="closeConfirm()">Cancel</button>
      <button class="btn btn-danger" id="confirmYes">Delete</button>
    </div>
  </div>
</div>

  <!-- Keep all your existing JavaScript functions -->
  <script>

    const BASE_URL = 'http://65.0.105.4:5000'; // Updated to EC2 public IP

    // Ensure all API calls use the correct base URL
    // Example usage:
    // fetch(`${BASE_URL}/api-endpoint`, { method: 'GET' })
    //   .then(response => response.json())
    //   .then(data => console.log(data));

    if (!localStorage.getItem("role")) {
  localStorage.setItem("role", "admin"); // future: teacher, student
}


    function showToast(message, type = "success") {
  const container = document.getElementById("toastContainer");
  const toast = document.createElement("div");
  toast.className = `toast ${type}`;
  toast.innerText = message;
  container.appendChild(toast);

  setTimeout(() => toast.remove(), 3000);
}


    const BASE_URL = 'https://edvantage.onrender.com';


function logout() {
            localStorage.removeItem('AdminId');
            localStorage.removeItem('AdminName');
            localStorage.removeItem('AdminEmail');
            localStorage.removeItem('AdminPhone');
            localStorage.removeItem('AdminPassword');
            window.location.href = "index.html";
        }
    // Function to show the selected tab
    function showTab(tabId) {
  const contents = document.querySelectorAll('.tab-content');
  const buttons = document.querySelectorAll('.sidebar-nav a');
  const breadcrumb = document.getElementById("breadcrumb");
  breadcrumb.innerText = `Admin / ${tabId.replace('-', ' ')}`;

  setTimeout(() => {
  const firstInput = document
    .getElementById(tabId)
    ?.querySelector("input, select, textarea");
  firstInput?.focus();
}, 250);




  // Hide all tabs
  contents.forEach(c => c.classList.remove('active'));

  // Remove active class from all nav links
  buttons.forEach(b => b.classList.remove('active'));

  // Show selected tab
  document.getElementById(tabId).classList.add('active');

  // Add active class to the clicked sidebar item
  event.currentTarget.classList.add('active');

  // Load relevant dropdowns/data
  if (tabId === 'teacher') loadTeachersDropdown();
  if (tabId === 'student') loadStudentsDropdown();
  if (tabId === 'course') loadCoursesDropdown();
  if (tabId === 'subject') loadSubjectsDropdown();
  if (tabId === 'assign') loadDropdowns();
  if (tabId === 'view-all') loadAllData();
}


    // Function to load all dropdowns
    async function loadDropdowns() {
      await loadTeachersDropdown();
      await loadStudentsDropdown();
      await loadCoursesDropdown();
      await loadSubjectsDropdown();
    }

    // Function to load teachers dropdown
    async function loadTeachersDropdown() {
      const res = await fetch('https://edvantage.onrender.com/teachers');
      const data = await res.json();
      const dropdown = document.getElementById('teacher-dropdown');
      dropdown.innerHTML = '';
      data.forEach(t => {
        const option = document.createElement('option');
        option.value = t._id;
        option.textContent = t.name;
        dropdown.appendChild(option);
      });
    }

    // Function to load students dropdown
    async function loadStudentsDropdown() {
      const res = await fetch('https://edvantage.onrender.com/students');
      const data = await res.json();
      const dropdown = document.getElementById('students-dropdown');
      dropdown.innerHTML = '';
      data.forEach(s => {
        const option = document.createElement('option');
        option.value = s._id;
        option.textContent = s.name;
        dropdown.appendChild(option);
      });
    }

    // Function to load courses dropdown
    async function loadCoursesDropdown() {
      const res = await fetch('https://edvantage.onrender.com/courses');
      const data = await res.json();
      const dropdowns = [document.getElementById('subject-course-dropdown'), document.getElementById('assign-course-dropdown')];
      dropdowns.forEach(dropdown => {
        dropdown.innerHTML = '';
        data.forEach(c => {
          const option = document.createElement('option');
          option.value = c._id;
          option.textContent = c.name;
          dropdown.appendChild(option);
        });
      });
    }

    // Function to load subjects dropdown
    async function loadSubjectsDropdown() {
      const res = await fetch('https://edvantage.onrender.com/subjects');
      const data = await res.json();
      const dropdown = document.getElementById('assign-subject-dropdown');
      dropdown.innerHTML = '';
      data.forEach(s => {
        const option = document.createElement('option');
        option.value = s._id;
        option.textContent = s.name;
        dropdown.appendChild(option);
      });
    }

    // Function to add a teacher
    async function addTeacher() {
  const teacherId = document.getElementById('teacher-id').value.trim();
  const name = document.getElementById('teacher-name').value.trim();
  const email = document.getElementById('teacher-email').value.trim();
  const phone = document.getElementById('teacher-phone').value.trim();
  const password = document.getElementById('teacher-password').value.trim();

  if (!teacherId || !name || !email || !phone || !password) {
    showToast('Please fill all fields.');
    return;
  }

  try {
    const res = await fetch('https://edvantage.onrender.com/add-teacher', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ teacherId, name, email, phone, password })
    });

    if (!res.ok) {
      throw new Error('Failed to add teacher');
    }

    const data = await res.json();
    showToast('Teacher added!');
    document.getElementById('teacher-id').value = '';
    document.getElementById('teacher-name').value = '';
    document.getElementById('teacher-email').value = '';
    document.getElementById('teacher-phone').value = '';
    document.getElementById('teacher-password').value = '';
    loadTeachersDropdown(); // Refresh dropdown if needed
  } catch (error) {
    console.error('Error adding teacher:', error);
    showToast('Failed to add teacher. Check the console for details.');
  }
}

    // Function to add a student
    async function addStudent() {
  const studentId = document.getElementById('student-id').value;
  const name = document.getElementById('student-name').value;
  const email = document.getElementById('student-email').value;
  const phone = document.getElementById('student-phone').value;
  const password = document.getElementById('student-password').value;

  try {
    const res = await fetch('https://edvantage.onrender.com/add-student', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ studentId, name, email, phone, password }),
    });
    if (!res.ok) {
      throw new Error('Failed to add student');
    }
    const data = await res.json();
    showToast('Student added!');
    document.getElementById('student-id').value = '';
    document.getElementById('student-name').value = '';
    document.getElementById('student-email').value = '';
    document.getElementById('student-phone').value = '';
    document.getElementById('student-password').value = '';
    loadStudentsDropdown(); // Refresh dropdown if needed
  } catch (error) {
    console.error('Error adding student:', error);
    showToast('Failed to add student. Check the console for details.');
  }
}

    // Function to add a course
    async function addCourse() {
      const name = document.getElementById('course-name').value;
      try {
        const res = await fetch('https://edvantage.onrender.com/add-course', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ name })
        });
        if (!res.ok) {
          throw new Error('Failed to add course');
        }
        const data = await res.json();
        showToast('Course added!');
        loadCoursesDropdown(); // Refresh dropdown
      } catch (error) {
        console.error('Error adding course:', error);
        showToast('Failed to add course. Check the console for details.');
      }
    }
    

    // Function to add a subject
    async function addSubject() {
      const name = document.getElementById('subject-name').value;
      const courseId = document.getElementById('subject-course-dropdown').value;
      try {
        const res = await fetch('https://edvantage.onrender.com/add-subject', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ name, courseId })
        });
        if (!res.ok) {
          throw new Error('Failed to add subject');
        }
        const data = await res.json();
        showToast('Subject added!');
        loadSubjectsDropdown(); // Refresh dropdown
      } catch (error) {
        console.error('Error adding subject:', error);
        showToast('Failed to add subject. Check the console for details.');
      }
    }

    // Function to assign a class
    async function assignClass() {
      const className = document.getElementById('class-name').value;
      const teacherId = document.getElementById('teacher-dropdown').value;
      const studentIds = Array.from(document.getElementById('students-dropdown').selectedOptions).map(opt => opt.value);
      const courseId = document.getElementById('assign-course-dropdown').value;
      const subjectId = document.getElementById('assign-subject-dropdown').value;
      try {
        const res = await fetch('https://edvantage.onrender.com/assign-class', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ className, teacherId, studentIds, courseId, subjectId })
        });
        if (!res.ok) {
          throw new Error('Failed to assign class');
        }
        const data = await res.json();
        showToast('Class assigned!');
        loadAssignedClasses(); // Refresh assigned classes table
      } catch (error) {
        console.error('Error assigning class:', error);
        showToast('Failed to assign class. Check the console for details.');
      }
    }

    // Function to load all data in the "View All" tab
    async function loadAllData() {
      await loadTeachers();
      await loadStudents();
      await loadCourses();
      await loadSubjects();
      await loadAssignedClasses();
      paginateTable("view-all-teachers");
      paginateTable("view-all-students");

    }

    // Function to load teachers in the "View All" tab
    // Function to load teachers in the "View All" tab
async function loadTeachers() {
  const res = await fetch('https://edvantage.onrender.com/teachers');
  const data = await res.json();
  const tableBody = document.querySelector('#view-all-teachers tbody');
  tableBody.innerHTML = '';
  data.forEach(t => {
    const row = document.createElement('tr');
    row.setAttribute('data-id', t._id);
    row.innerHTML = `
      <td>${t.teacherId}</td>
      <td>${t.name}</td>
      <td>${t.email}</td>
      <td>${t.phone}</td>
      <td class="action-btns">
        <button class="btn btn-secondary btn-small" onclick="startEditTeacher('${t._id}')">Edit</button>
        <button class="btn btn-danger btn-small" onclick="deleteTeacher('${t._id}')">Delete</button>

      </td>
    `;
    tableBody.appendChild(row);
  });
}

// Function to load students in the "View All" tab
async function loadStudents() {
  const res = await fetch('https://edvantage.onrender.com/students');
  const data = await res.json();
  const tableBody = document.querySelector('#view-all-students tbody');
  tableBody.innerHTML = '';
  data.forEach(s => {
    const row = document.createElement('tr');
    row.setAttribute('data-id', s._id);
    row.innerHTML = `
      <td>${s.studentId}</td>
      <td>${s.name}</td>
      <td>${s.email}</td>
      <td>${s.phone}</td>
      <td class="action-btns">
        <button class="btn btn-secondary btn-small" onclick="startEditStudent('${s._id}')">Edit</button>
<button class="btn btn-danger btn-small" onclick="confirmDelete(() => deleteStudent('${s._id}'))">Delete</button>

      </td>
    `;
    tableBody.appendChild(row);
  });
}

// Function to load courses in the "View All" tab
async function loadCourses() {
  const res = await fetch('https://edvantage.onrender.com/courses');
  const data = await res.json();
  const tableBody = document.querySelector('#view-all-courses tbody');
  tableBody.innerHTML = '';
  data.forEach(c => {
    const row = document.createElement('tr');
    row.setAttribute('data-id', c._id);
    row.innerHTML = `
      <td>${c.name}</td>
      <td class="action-btns">
        <button class="edit" onclick="editCourse('${c._id}')">Edit</button>
        <button class="delete" onclick="deleteCourse('${c._id}')">Delete</button>
      </td>
    `;
    tableBody.appendChild(row);
  });
}

// Function to load subjects in the "View All" tab
async function loadSubjects() {
  const res = await fetch('https://edvantage.onrender.com/subjects');
  const data = await res.json();
  const tableBody = document.querySelector('#view-all-subjects tbody');
  tableBody.innerHTML = '';
  data.forEach(s => {
    const row = document.createElement('tr');
    row.setAttribute('data-id', s._id);
    row.innerHTML = `
      <td>${s.name}</td>
      <td>${s.course ? s.course.name : 'N/A'}</td>
      <td class="action-btns">
        <button class="edit" onclick="editSubject('${s._id}')">Edit</button>
        <button class="delete" onclick="deleteSubject('${s._id}')">Delete</button>
      </td>
    `;
    tableBody.appendChild(row);
  });
}

    // Function to load assigned classes in the "View All" tab
    async function loadAssignedClasses() {
      const res = await fetch('https://edvantage.onrender.com/classes');
      const data = await res.json();
      const tableBody = document.querySelector('#view-all-classes tbody');
      tableBody.innerHTML = '';
      data.forEach(cls => {
        tableBody.innerHTML += `
          <tr>
            <td>${cls.name}</td>
            <td>${cls.teacher ? cls.teacher.name : 'N/A'}</td>
            <td>${cls.students ? cls.students.map(s => s.name).join(', ') : 'N/A'}</td>
            <td>${cls.course ? cls.course.name : 'N/A'}</td>
            <td>${cls.subject ? cls.subject.name : 'N/A'}</td>
            <td>
              <button class="delete" onclick="deleteClass('${cls._id}')">Delete</button>
            </td>
          </tr>
        `;
      });
    }

    // Function to edit a teacher
  // Function to edit a teacher
async function editTeacher(id) {
  const row = document.querySelector(`#view-all-teachers tr[data-id="${id}"]`);
  if (!row) return;
  
  const teacherId = row.cells[0].textContent;
  const name = row.cells[1].textContent;
  const email = row.cells[2].textContent;
  const phone = row.cells[3].textContent;
  
  const newName = prompt("Enter new name:", name);
  if (newName === null) return;
  
  const newEmail = prompt("Enter new email:", email);
  if (newEmail === null) return;
  
  const newPhone = prompt("Enter new phone:", phone);
  if (newPhone === null) return;
  
  try {
    const res = await fetch(`https://edvantage.onrender.com/edit-teacher/${id}`, {
      method: 'PUT',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ 
        teacherId, 
        name: newName, 
        email: newEmail, 
        phone: newPhone 
      })
    });
    
    if (res.ok) {
      showToast('Teacher updated successfully!');
      loadTeachers();
    } else {
      throw new Error('Failed to update teacher');
    }
  } catch (error) {
    console.error('Error updating teacher:', error);
    showToast('Failed to update teacher. Check console for details.');
  }
}

// Function to delete a teacher
async function deleteTeacher(id) {
  if (!confirm('Are you sure you want to delete this teacher?')) return;
  
  try {
    const res = await fetch(`https://edvantage.onrender.com/delete-teacher/${id}`, {
      method: 'DELETE'
    });
    
    if (res.ok) {
      showToast('Teacher deleted successfully!');
      loadTeachers();
    } else {
      throw new Error('Failed to delete teacher');
    }
  } catch (error) {
    console.error('Error deleting teacher:', error);
    showToast('Failed to delete teacher. Check console for details.');
  }
}

// Function to edit a student
async function editStudent(id) {
  const row = document.querySelector(`#view-all-students tr[data-id="${id}"]`);
  if (!row) return;
  
  const studentId = row.cells[0].textContent;
  const name = row.cells[1].textContent;
  const email = row.cells[2].textContent;
  const phone = row.cells[3].textContent;
  
  const newName = prompt("Enter new name:", name);
  if (newName === null) return;
  
  const newEmail = prompt("Enter new email:", email);
  if (newEmail === null) return;
  
  const newPhone = prompt("Enter new phone:", phone);
  if (newPhone === null) return;
  
  try {
    const res = await fetch(`https://edvantage.onrender.com/edit-student/${id}`, {
      method: 'PUT',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ 
        studentId, 
        name: newName, 
        email: newEmail, 
        phone: newPhone 
      })
    });
    
    if (res.ok) {
      showToast('Student updated successfully!');
      loadStudents();
    } else {
      throw new Error('Failed to update student');
    }
  } catch (error) {
    console.error('Error updating student:', error);
    showToast('Failed to update student. Check console for details.');
  }
}

// Function to delete a student
async function deleteStudent(id) {
  if (!confirm('Are you sure you want to delete this student?')) return;
  
  try {
    const res = await fetch(`https://edvantage.onrender.com/delete-student/${id}`, {
      method: 'DELETE'
    });
    
    if (res.ok) {
      showToast('Student deleted successfully!');
      loadStudents();
    } else {
      throw new Error('Failed to delete student');
    }
  } catch (error) {
    console.error('Error deleting student:', error);
    showToast('Failed to delete student. Check console for details.');
  }
}

// Function to edit a course
async function editCourse(id) {
  const row = document.querySelector(`#view-all-courses tr[data-id="${id}"]`);
  if (!row) return;
  
  const currentName = row.cells[0].textContent;
  const newName = prompt("Enter new course name:", currentName);
  
  if (newName && newName !== currentName) {
    try {
      const res = await fetch(`https://edvantage.onrender.com/edit-course/${id}`, {
        method: 'PUT',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ name: newName })
      });
      
      if (res.ok) {
        showToast('Course updated successfully!');
        loadCourses();
      } else {
        throw new Error('Failed to update course');
      }
    } catch (error) {
      console.error('Error updating course:', error);
      showToast('Failed to update course. Check console for details.');
    }
  }
}

// Function to edit a subject
async function editSubject(id) {
  const row = document.querySelector(`#view-all-subjects tr[data-id="${id}"]`);
  if (!row) return;
  
  const currentName = row.cells[0].textContent;
  const newName = prompt("Enter new subject name:", currentName);
  
  if (newName && newName !== currentName) {
    try {
      const res = await fetch(`https://edvantage.onrender.com/edit-subject/${id}`, {
        method: 'PUT',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ name: newName })
      });
      
      if (res.ok) {
        showToast('Subject updated successfully!');
        loadSubjects();
      } else {
        throw new Error('Failed to update subject');
      }
    } catch (error) {
      console.error('Error updating subject:', error);
      showToast('Failed to update subject. Check console for details.');
    }
  }
}
 // Function to delete a course
async function deleteCourse(id) {
  if (!confirm('Are you sure you want to delete this course? This will also delete all associated subjects.')) {
    return;
  }

  try {
    const res = await fetch(`https://edvantage.onrender.com/delete-course/${id}`, {
      method: 'DELETE'
    });

    if (!res.ok) {
      throw new Error('Failed to delete course');
    }

    const data = await res.json();
    showToast('Course deleted successfully!');
    loadCourses(); // Refresh the courses list
    loadSubjects(); // Refresh subjects as some might have been deleted
    loadDropdowns(); // Refresh dropdowns that might contain courses
  } catch (error) {
    console.error('Error deleting course:', error);
    showToast('Failed to delete course. Check console for details.');
  }
}

// Function to delete a subject
async function deleteSubject(id) {
  if (!confirm('Are you sure you want to delete this subject?')) {
    return;
  }

  try {
    const res = await fetch(`https://edvantage.onrender.com/delete-subject/${id}`, {
      method: 'DELETE'
    });

    if (!res.ok) {
      throw new Error('Failed to delete subject');
    }

    const data = await res.json();
    showToast('Subject deleted successfully!');
    loadSubjects(); // Refresh the subjects list
    loadDropdowns(); // Refresh dropdowns that might contain subjects
  } catch (error) {
    console.error('Error deleting subject:', error);
    showToast('Failed to delete subject. Check console for details.');
  }
}


    // Function to delete a class
    async function deleteClass(id) {
      await fetch(`https://edvantage.onrender.com/delete-class/${id}`, { method: 'DELETE' });
      showToast('Class deleted!');
      loadAssignedClasses();
    }

    // Load dropdowns on page load
    window.onload = loadDropdowns;

    // Add these new functions
async function importStudentsFromExcel() {
    const fileInput = document.getElementById('excel-file');
    const file = fileInput.files[0];
    
    if (!file) {
        showToast('Please select an Excel file');
        return;
    }

    try {
        // Read Excel file
        const data = await readExcelFile(file);
        
        // Validate and format the data
        const students = formatStudentData(data);
        
        if (students.length === 0) {
            showToast('No valid student data found in the file');
            return;
        }

        // Send to server
        const res = await fetch('https://edvantage.onrender.com/import-students', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ students })
        });

        if (!res.ok) {
            throw new Error('Failed to import students');
        }

        showToast(`${students.length} students imported successfully!`);
        loadStudents(); // Refresh the student list
        fileInput.value = ''; // Clear file input
    } catch (error) {
        console.error('Import error:', error);
        showToast('Error importing students: ' + error.message);
    }
}

function readExcelFile(file) {
    return new Promise((resolve, reject) => {
        const reader = new FileReader();
        
        reader.onload = (e) => {
            try {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, { type: 'array' });
                const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                const jsonData = XLSX.utils.sheet_to_json(firstSheet);
                resolve(jsonData);
            } catch (err) {
                reject(err);
            }
        };
        
        reader.onerror = (error) => reject(error);
        reader.readAsArrayBuffer(file);
    });
}

function formatStudentData(data) {
    return data.map(row => ({
        studentId: row['Student ID'] || row['studentId'] || '',
        name: row['Name'] || row['name'] || '',
        email: row['Email'] || row['email'] || '',
        phone: row['Phone'] || row['phone'] || '',
        password: row['Password'] || row['password'] || 'default123' // Default password if not provided
    })).filter(student => 
        student.studentId && student.name && student.email
    );
}

// Add this function to the script section
function downloadSampleExcel() {
    // Sample data
    const sampleData = [
        {
            "Student ID": "ST001",
            "Name": "John Doe",
            "Email": "john@example.com",
            "Phone": "1234567890",
            "Password": "password123"
        },
        {
            "Student ID": "ST002",
            "Name": "Jane Smith",
            "Email": "jane@example.com",
            "Phone": "9876543210",
            "Password": "password456"
        }
    ];

    // Create workbook
    const wb = XLSX.utils.book_new();
    const ws = XLSX.utils.json_to_sheet(sampleData);
    XLSX.utils.book_append_sheet(wb, ws, "Students");

    // Generate and download
    XLSX.writeFile(wb, "students_sample.xlsx");
}

async function importStudentsFromExcel() {
    const fileInput = document.getElementById('excel-file');
    const file = fileInput.files[0];
    
    // Basic check if a file is selected
    if (!file) {
        showToast("ðŸš« Please select an Excel file first!");
        return;
    }

    // Check if it's an .xlsx file (case-insensitive)
    if (!file.name.toLowerCase().endsWith('.xlsx')) {
        showToast("âŒ Only .xlsx files are allowed!\nDownload the sample template for the correct format.");
        return;
    }

    // Proceed with import if checks pass
    try {
        const data = await readExcelFile(file);
        const students = formatStudentData(data);
        
        if (students.length === 0) {
            showToast("âš ï¸ No valid data found. Check the file format.");
            return;
        }

        const res = await fetch('https://edvantage.onrender.com/import-students', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ students })
        });

        if (!res.ok) throw new Error("Server rejected the file.");
        
        showToast(`âœ… Success! ${students.length} students imported.`);
        fileInput.value = ""; // Clear the input
        loadStudents(); // Refresh the list
    } catch (error) {
        showToast(`âŒ Import failed: ${error.message}`);
        console.error("Import error:", error);
    }
}

 document.addEventListener('DOMContentLoaded', function() {
    const themeToggle = document.createElement('div');
    themeToggle.className = 'theme-toggle';
    themeToggle.innerHTML = `
      <div class="toggle-container">
        <i class="fas fa-adjust toggle-icon"></i>
      </div>
    `;
    document.body.appendChild(themeToggle);
    
    // Check for saved theme preference
    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    const savedTheme = localStorage.getItem('theme');
    
    if (savedTheme === 'dark' || (!savedTheme && prefersDark)) {
      document.body.classList.add('dark');
    }
    
    // Toggle theme on click
    themeToggle.addEventListener('click', function() {
      const container = themeToggle.querySelector('.toggle-container');
      const icon = themeToggle.querySelector('.toggle-icon');
      
      // Add animation class
      container.classList.add('theme-changed');
      
      // Remove animation class after it completes
      setTimeout(() => {
        container.classList.remove('theme-changed');
      }, 600);
      
      // Toggle theme
      document.body.classList.toggle('dark');
      const isDark = document.body.classList.contains('dark');
      localStorage.setItem('theme', isDark ? 'dark' : 'light');
      
      // Change icon with rotation effect
      if (isDark) {
        icon.classList.replace('fa-sun', 'fa-adjust');
        icon.classList.replace('fa-moon', 'fa-adjust');
      }
    });
    
    // Listen for system theme changes
    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
      if (!localStorage.getItem('theme')) {
        document.body.classList.toggle('dark', e.matches);
      }
    });
  });

  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('service-worker.js');
  }

  //new
  function validateRequired(fields) {
  let valid = true;

  fields.forEach(id => {
    const input = document.getElementById(id);
    input.classList.remove("invalid");

    if (!input.value.trim()) {
      input.classList.add("invalid");
      valid = false;
    }
  });

  if (!valid) showToast("Please fill all required fields", "error");
  return valid;
}


function setLoading(btn, state) {
  if (state) btn.classList.add("loading");
  else btn.classList.remove("loading");
}


function filterTables() {
  const query = document.getElementById("globalSearch").value.toLowerCase();
  const tables = [
    "view-all-teachers",
    "view-all-students",
    "view-all-courses",
    "view-all-subjects"
  ];

  tables.forEach(id => {
    const rows = document.querySelectorAll(`#${id} tbody tr`);
    rows.forEach(row => {
      row.style.display = row.innerText.toLowerCase().includes(query)
        ? ""
        : "none";
    });
  });
}


function paginateTable(tableId, rowsPerPage = 6) {
  const table = document.getElementById(tableId);
  const tbody = table.querySelector("tbody");
  const rows = Array.from(tbody.children);
  const pageCount = Math.ceil(rows.length / rowsPerPage);

  let currentPage = 1;

  function renderPage(page) {
    currentPage = page;
    rows.forEach((row, index) => {
      row.style.display =
        index >= (page - 1) * rowsPerPage &&
        index < page * rowsPerPage
          ? ""
          : "none";
    });
    renderPagination();
  }

  function renderPagination() {
    let container = table.nextElementSibling;
    if (!container || !container.classList.contains("pagination")) {
      container = document.createElement("div");
      container.className = "pagination";
      table.after(container);
    }

    container.innerHTML = "";
    for (let i = 1; i <= pageCount; i++) {
      const btn = document.createElement("button");
      btn.innerText = i;
      btn.className = i === currentPage ? "active" : "";
      btn.onclick = () => renderPage(i);
      container.appendChild(btn);
    }
  }

  renderPage(1);
}


document.addEventListener("keydown", e => {
  if (e.ctrlKey && e.key === "1") showTab("teacher");
  if (e.ctrlKey && e.key === "2") showTab("student");
  if (e.ctrlKey && e.key === "3") showTab("course");
  if (e.ctrlKey && e.key === "4") showTab("subject");
  if (e.ctrlKey && e.key === "5") showTab("assign");
  if (e.ctrlKey && e.key === "6") showTab("view-all");
});

let editingTeacherId = null;

function startEditTeacher(id) {
  if (editingTeacherId) {
    showToast("Finish current edit first", "error");
    return;
  }

  const row = document.querySelector(`#view-all-teachers tr[data-id="${id}"]`);
  if (!row) return;

  editingTeacherId = id;

  const cells = row.querySelectorAll("td");

  const values = [
    cells[0].innerText,
    cells[1].innerText,
    cells[2].innerText,
    cells[3].innerText
  ];

  cells[0].innerHTML = `<input class="table-input" value="${values[0]}" disabled>`;
  cells[1].innerHTML = `<input class="table-input" value="${values[1]}">`;
  cells[2].innerHTML = `<input class="table-input" value="${values[2]}">`;
  cells[3].innerHTML = `<input class="table-input" value="${values[3]}">`;

  cells[4].innerHTML = `
    <div class="row-actions">
      <button class="btn btn-success btn-small" onclick="saveTeacher('${id}')">Save</button>
      <button class="btn btn-secondary btn-small" onclick="cancelTeacherEdit('${id}')">Cancel</button>
    </div>
  `;
}

function cancelTeacherEdit(id) {
  editingTeacherId = null;
  loadTeachers();
}

async function saveTeacher(id) {
  const row = document.querySelector(`#view-all-teachers tr[data-id="${id}"]`);
  const inputs = row.querySelectorAll("input");

  const teacherId = inputs[0].value.trim();
  const name = inputs[1].value.trim();
  const email = inputs[2].value.trim();
  const phone = inputs[3].value.trim();

  if (!name || !email || !phone) {
    showToast("All fields are required", "error");
    return;
  }

  try {
    const res = await fetch(`https://edvantage.onrender.com/teachers/${id}`, {
      method: "PUT",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ teacherId, name, email, phone })
    });

    if (!res.ok) throw new Error();

    showToast("Teacher updated successfully");
    editingTeacherId = null;
    loadTeachers();
  } catch {
    showToast("Update failed", "error");
  }
}

let editingStudentId = null;

function startEditStudent(id) {
  if (editingStudentId) {
    showToast("Finish current edit first", "error");
    return;
  }

  const row = document.querySelector(`#view-all-students tr[data-id="${id}"]`);
  editingStudentId = id;

  const cells = row.querySelectorAll("td");

  const values = [
    cells[0].innerText,
    cells[1].innerText,
    cells[2].innerText,
    cells[3].innerText
  ];

  cells[0].innerHTML = `<input class="table-input" value="${values[0]}" disabled>`;
  cells[1].innerHTML = `<input class="table-input" value="${values[1]}">`;
  cells[2].innerHTML = `<input class="table-input" value="${values[2]}">`;
  cells[3].innerHTML = `<input class="table-input" value="${values[3]}">`;

  cells[4].innerHTML = `
    <div class="row-actions">
      <button class="btn btn-success btn-small" onclick="saveStudent('${id}')">Save</button>
      <button class="btn btn-secondary btn-small" onclick="cancelStudentEdit()">Cancel</button>
    </div>
  `;
}

function cancelStudentEdit() {
  editingStudentId = null;
  loadStudents();
}

async function saveStudent(id) {
  const row = document.querySelector(`#view-all-students tr[data-id="${id}"]`);
  const inputs = row.querySelectorAll("input");

  const studentId = inputs[0].value;
  const name = inputs[1].value;
  const email = inputs[2].value;
  const phone = inputs[3].value;

  if (!name || !email || !phone) {
    showToast("All fields required", "error");
    return;
  }

  try {
    const res = await fetch(`https://edvantage.onrender.com/students/${id}`, {
      method: "PUT",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ studentId, name, email, phone })
    });

    if (!res.ok) throw new Error();

    showToast("Student updated");
    editingStudentId = null;
    loadStudents();
  } catch {
    showToast("Update failed", "error");
  }
}

let confirmCallback = null;

function confirmDelete(callback) {
  confirmCallback = callback;
  document.getElementById("confirmModal").style.display = "flex";
}

function closeConfirm() {
  document.getElementById("confirmModal").style.display = "none";
  confirmCallback = null;
}

document.getElementById("confirmYes").onclick = () => {
  confirmCallback?.();
  closeConfirm();
};

function enableSorting(tableId) {
  const headers = document.querySelectorAll(`#${tableId} th`);
  headers.forEach((th, index) => {
    let asc = true;
    th.style.cursor = "pointer";

    th.onclick = () => {
      const tbody = document.querySelector(`#${tableId} tbody`);
      const rows = Array.from(tbody.querySelectorAll("tr"));

      rows.sort((a, b) => {
        const A = a.children[index].innerText.toLowerCase();
        const B = b.children[index].innerText.toLowerCase();
        return asc ? A.localeCompare(B) : B.localeCompare(A);
      });

      asc = !asc;
      rows.forEach(tr => tbody.appendChild(tr));
    };
  });
}

enableSorting("view-all-teachers");
enableSorting("view-all-students");
enableSorting("view-all-courses");
enableSorting("view-all-subjects");


// ===============================
// HAMBURGER SIDEBAR TOGGLE SYSTEM
// ===============================

document.addEventListener("DOMContentLoaded", () => {
  const hamburger = document.getElementById("hamburgerBtn");
  const sidebar = document.querySelector(".sidebar");
  const overlay = document.getElementById("mobileOverlay");
  const mainContent = document.querySelector(".main-content");

  const savedState = localStorage.getItem("sidebarCollapsed");
  if (savedState === "true") {
    sidebar.classList.add("collapsed");
    mainContent.classList.add("collapsed");
    hamburger.classList.add("active");
  }

  hamburger.addEventListener("click", () => {
    const isMobile = window.innerWidth <= 768;

    if (isMobile) {
    sidebar.classList.toggle("active");
    overlay.style.display = sidebar.classList.contains("active")
      ? "block"
      : "none";

    document.body.classList.toggle(
      "menu-open",
    sidebar.classList.contains("active")
    );
    }

    else {
      sidebar.classList.toggle("collapsed");
      mainContent.classList.toggle("collapsed");
      hamburger.classList.toggle("active");

      localStorage.setItem(
        "sidebarCollapsed",
        sidebar.classList.contains("collapsed")
      );
    }
  });
  overlay.addEventListener("click", () => {
  sidebar.classList.remove("active");
  overlay.style.display = "none";
  document.body.classList.remove("menu-open");
});
});

let touchStartX = 0;

document.addEventListener("touchstart", e => {
  touchStartX = e.touches[0].clientX;
});

document.addEventListener("touchend", e => {
  const touchEndX = e.changedTouches[0].clientX;
  const diffX = touchEndX - touchStartX;

  const sidebar = document.querySelector(".sidebar");
  const overlay = document.getElementById("mobileOverlay");

  // Swipe left to close
  if (diffX < -60 && sidebar.classList.contains("active")) {
    sidebar.classList.remove("active");
    overlay.style.display = "none";
    document.body.classList.remove("menu-open");
  }
});



// ===============================
// AUTO CLOSE SIDEBAR ON NAV CLICK (MOBILE)
// ===============================

function setupMobileMenuAutoClose() {
  const sidebar = document.querySelector(".sidebar");
  const overlay = document.getElementById("mobileOverlay");
  const hamburger = document.getElementById("hamburgerBtn");

  document.querySelectorAll(".sidebar a").forEach(link => {
    link.addEventListener("click", () => {
      const isMobile = window.innerWidth <= 768;

      if (isMobile) {
        sidebar.classList.remove("active");
        hamburger.classList.remove("active");

        // Delay overlay hide for animation smoothness
        setTimeout(() => {
          overlay.style.display = "none";
          document.body.classList.remove("menu-open");
        }, 200);
      }
    });
  });
}

document.addEventListener("DOMContentLoaded", setupMobileMenuAutoClose);


  </script>

</body>
</html>